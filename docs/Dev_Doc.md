\# CS2 Majorçº§åˆ«èµ›äº‹ç›´æ’­Overlayç³»ç»Ÿ - å®Œæ•´é¡¹ç›®æ–‡æ¡£



\## ğŸ“‹ ç›®å½•



1\. \[é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)

2\. \[æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)

3\. \[åŠŸèƒ½éœ€æ±‚](#åŠŸèƒ½éœ€æ±‚)

4\. \[å¼€å‘è®¡åˆ’](#å¼€å‘è®¡åˆ’)

5\. \[æŠ€æœ¯é€‰å‹](#æŠ€æœ¯é€‰å‹)

6\. \[ç³»ç»Ÿè®¾è®¡](#ç³»ç»Ÿè®¾è®¡)

7\. \[å®ç°ç»†èŠ‚](#å®ç°ç»†èŠ‚)

8\. \[éƒ¨ç½²æŒ‡å—](#éƒ¨ç½²æŒ‡å—)

9\. \[ä½¿ç”¨æ‰‹å†Œ](#ä½¿ç”¨æ‰‹å†Œ)

10\. \[é™„å½•](#é™„å½•)



---



\## é¡¹ç›®æ¦‚è¿°



\### é¡¹ç›®ç›®æ ‡

å¼€å‘ä¸€å¥—å®Œæ•´çš„CS2èµ›äº‹ç›´æ’­Overlayç³»ç»Ÿï¼Œæ”¯æŒæ¯”åˆ†æ˜¾ç¤ºã€BPæµç¨‹ã€é€‰æ‰‹ä¿¡æ¯ç­‰æ‰€æœ‰èµ›äº‹æ‰€éœ€çš„å›¾å½¢å åŠ å±‚ï¼Œå¹¶æä¾›å®Œæ•´çš„åå°æ§åˆ¶é¢æ¿ã€‚



\### æ ¸å¿ƒç‰¹æ€§

\- âœ… å®æ—¶æ¯”åˆ†æ›´æ–°

\- âœ… BPï¼ˆBan/Pickï¼‰ç³»ç»Ÿ

\- âœ… å¤šç§Overlayåœºæ™¯

\- âœ… å¯è§†åŒ–æ§åˆ¶é¢æ¿

\- âœ… OBSæµè§ˆå™¨æºé›†æˆ

\- âœ… åŠ¨ç”»æ•ˆæœæ”¯æŒ

\- âœ… ä¸»é¢˜è‡ªå®šä¹‰



\### ç›®æ ‡ç”¨æˆ·

\- èµ›äº‹ä¸»åŠæ–¹

\- ç›´æ’­å¯¼æ’­

\- èµ›äº‹æ•°æ®å‘˜

\- å†…å®¹åˆ›ä½œè€…



---



\## æŠ€æœ¯æ¶æ„



\### æ•´ä½“æ¶æ„å›¾



```

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”

â”‚                      OBS Studio                          â”‚

â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚

â”‚  â”‚ Browser Src  â”‚  â”‚ Browser Src  â”‚  â”‚ Browser Src  â”‚  â”‚

â”‚  â”‚  Scoreboard  â”‚  â”‚     BP       â”‚  â”‚ Lower-third  â”‚  â”‚

â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚

â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

&nbsp;         â”‚                  â”‚                  â”‚

&nbsp;         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

&nbsp;                            â”‚ WebSocket

&nbsp;         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”

&nbsp;         â”‚                                     â”‚

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”

â”‚   Frontend Web    â”‚              â”‚   Admin Dashboard    â”‚

â”‚  (Overlay Pages)  â”‚              â”‚  (Control Panel)     â”‚

â”‚                   â”‚              â”‚                      â”‚

â”‚  - React/Next.js  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  - Match Control    â”‚

â”‚  - TypeScript     â”‚   Commands   â”‚  - BP Control       â”‚

â”‚  - Framer Motion  â”‚              â”‚  - Scene Switch     â”‚

â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

&nbsp;         â”‚                                   â”‚

&nbsp;         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

&nbsp;                        â”‚ Socket.io

&nbsp;             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”

&nbsp;             â”‚   Backend Server    â”‚

&nbsp;             â”‚                     â”‚

&nbsp;             â”‚  - Node.js/Express  â”‚

&nbsp;             â”‚  - Socket.io        â”‚

&nbsp;             â”‚  - REST API         â”‚

&nbsp;             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

&nbsp;                        â”‚

&nbsp;             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”

&nbsp;             â”‚     Database        â”‚

&nbsp;             â”‚  PostgreSQL/MongoDB â”‚

&nbsp;             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```



\### æŠ€æœ¯æ ˆ



\#### å‰ç«¯

\- \*\*æ¡†æ¶\*\*: Next.js 16 + TypeScript

\- \*\*çŠ¶æ€ç®¡ç†\*\*: Zustand

\- \*\*åŠ¨ç”»\*\*: Framer Motion

\- \*\*æ ·å¼\*\*: Tailwind CSS

\- \*\*WebSocket\*\*: Socket.io-client

\- \*\*å›¾è¡¨\*\*: Recharts (å¯é€‰)



\#### åç«¯

\- \*\*è¿è¡Œæ—¶\*\*: Node.js 18+

\- \*\*æ¡†æ¶\*\*: Express

\- \*\*WebSocket\*\*: Socket.io

\- \*\*éªŒè¯\*\*: Zod

\- \*\*ORM\*\*: Prisma (å¯é€‰)



\#### æ•°æ®åº“

\- \*\*ä¸»æ•°æ®åº“\*\*: PostgreSQL æˆ– MongoDB

\- \*\*ç¼“å­˜\*\*: Redis (å¯é€‰)



\#### DevOps

\- \*\*å®¹å™¨åŒ–\*\*: Docker + Docker Compose

\- \*\*è¿›ç¨‹ç®¡ç†\*\*: PM2

\- \*\*åå‘ä»£ç†\*\*: Nginx



---



\## åŠŸèƒ½éœ€æ±‚



\### 1. Overlayé¡µé¢æ¨¡å—



\#### 1.1 æ¯”åˆ†æ¿ (Scoreboard)

\*\*è·¯ç”±\*\*: `/overlay/scoreboard`



\*\*åŠŸèƒ½éœ€æ±‚\*\*:

\- æ˜¾ç¤ºåŒæ–¹é˜Ÿä¼åç§°å’ŒLogo

\- å®æ—¶æ¯”åˆ†æ›´æ–°ï¼ˆå±€åˆ†ï¼‰

\- å½“å‰åœ°å›¾åç§°

\- å½“å‰å›åˆæ•°

\- BO3/BO5ç³»åˆ—èµ›è¿›åº¦

\- é˜Ÿä¼ç»æµæ˜¾ç¤ºï¼ˆå¯é€‰ï¼‰



\*\*äº¤äº’éœ€æ±‚\*\*:

\- æ¯”åˆ†æ›´æ–°æ—¶æ’­æ”¾åŠ¨ç”»

\- æ”¯æŒæ˜¾ç¤º/éšè—åˆ‡æ¢

\- å…¥åœº/é€€åœºåŠ¨ç”»



\*\*è®¾è®¡è¦æ±‚\*\*:

\- é€æ˜èƒŒæ™¯

\- å°ºå¯¸: 1920x1080 é€‚é…

\- åˆ·æ–°ç‡: 60fps



\#### 1.2 BPç³»ç»Ÿ (Ban/Pick)

\*\*è·¯ç”±\*\*: `/overlay/bp`



\*\*åŠŸèƒ½éœ€æ±‚\*\*:

\- åœ°å›¾æ± æ˜¾ç¤ºï¼ˆ7å¼ åœ°å›¾ï¼‰

\- Bané˜¶æ®µå¯è§†åŒ–

\- Pické˜¶æ®µå¯è§†åŒ–

\- å½“å‰æ“ä½œé˜Ÿä¼é«˜äº®

\- å€’è®¡æ—¶æ˜¾ç¤º

\- Ban/Pické¡ºåºæŒ‡ç¤º



\*\*æµç¨‹æ”¯æŒ\*\*:

\- BO1: Ban-Ban-Ban-Ban-Ban-Ban (å‰©ä½™1å›¾)

\- BO3: Ban-Ban-Pick-Pick-Ban-Ban (å‰©ä½™1å›¾)

\- BO5: Pick-Pick-Ban-Ban-Pick-Pick-Ban



\*\*äº¤äº’éœ€æ±‚\*\*:

\- Ban/Pickæ“ä½œå®æ—¶æ˜¾ç¤º

\- æ“ä½œç¡®è®¤åŠ¨ç”»

\- æ”¯æŒæ’¤é”€æ“ä½œ



\#### 1.3 é€‰æ‰‹ä¿¡æ¯æ¡ (Lower Third)

\*\*è·¯ç”±\*\*: `/overlay/lower-third`



\*\*åŠŸèƒ½éœ€æ±‚\*\*:

\- é€‰æ‰‹æ¸¸æˆID

\- çœŸå®å§“å

\- å›½ç±/å¤´åƒ

\- å½“å‰KDA

\- å‡»æ€æ•°é«˜äº®



\*\*äº¤äº’éœ€æ±‚\*\*:

\- æ»‘å…¥/æ»‘å‡ºåŠ¨ç”»

\- æ”¯æŒå•äºº/äº”äººæ¨¡å¼

\- è‡ªåŠ¨è½®æ’­ï¼ˆå¯é€‰ï¼‰



\#### 1.4 é¡¶éƒ¨ä¿¡æ¯æ  (Top Bar)

\*\*è·¯ç”±\*\*: `/overlay/top-bar`



\*\*åŠŸèƒ½éœ€æ±‚\*\*:

\- èµ›äº‹åç§°

\- æ¯”èµ›é˜¶æ®µï¼ˆå°ç»„èµ›/æ·˜æ±°èµ›ï¼‰

\- å½“å‰æ—¶é—´

\- èµåŠ©å•†Logo



\#### 1.5 åœ°å›¾ç¦é€‰ (Map Veto)

\*\*è·¯ç”±\*\*: `/overlay/map-veto`



\*\*åŠŸèƒ½éœ€æ±‚\*\*:

\- å®Œæ•´vetoæµç¨‹å±•ç¤º

\- å·²ban/pickåœ°å›¾çŠ¶æ€

\- æœ€ç»ˆåœ°å›¾æ± ç»“æœ



\#### 1.6 è¾…åŠ©Overlay

\- \*\*å€’è®¡æ—¶å™¨\*\* `/overlay/countdown` - æš‚åœå€’è®¡æ—¶

\- \*\*å›æ”¾æ ‡è¯†\*\* `/overlay/replay` - REPLAYå­—æ ·æ˜¾ç¤º

\- \*\*ä¸­åœºä¼‘æ¯\*\* `/overlay/break` - ä¼‘æ¯ç”»é¢

\- \*\*èµåŠ©å•†\*\* `/overlay/sponsor` - èµåŠ©å•†è½®æ’­

\- \*\*é€‰æ‰‹æ‘„åƒå¤´è¾¹æ¡†\*\* `/overlay/player-cam` - æ‘„åƒå¤´è£…é¥°æ¡†



\### 2. æ§åˆ¶é¢æ¿æ¨¡å—



\#### 2.1 ä¸»æ§åˆ¶å° (Dashboard)

\*\*è·¯ç”±\*\*: `/admin/dashboard`



\*\*åŠŸèƒ½éœ€æ±‚\*\*:

\- æ¯”èµ›æ€»è§ˆ

\- å¿«é€Ÿæ“ä½œé¢æ¿

\- å½“å‰overlayçŠ¶æ€

\- WebSocketè¿æ¥çŠ¶æ€

\- ç³»ç»Ÿæ—¥å¿—



\#### 2.2 æ¯”èµ›æ§åˆ¶ (Match Control)

\*\*è·¯ç”±\*\*: `/admin/match-control`



\*\*åŠŸèƒ½éœ€æ±‚\*\*:

\- é˜Ÿä¼ä¿¡æ¯ç¼–è¾‘

&nbsp; - é˜Ÿåã€Logoã€ç®€ç§°

&nbsp; - é€‰æ‰‹åå•

\- æ¯”åˆ†æ§åˆ¶

&nbsp; - +1/-1 æŒ‰é’®

&nbsp; - ç›´æ¥è¾“å…¥

&nbsp; - é‡ç½®åŠŸèƒ½

\- åœ°å›¾é€‰æ‹©

\- å›åˆæ•°æ§åˆ¶

\- æ¯”èµ›é˜¶æ®µåˆ‡æ¢



\*\*æ“ä½œè®°å½•\*\*:

\- æ‰€æœ‰æ“ä½œè®°å½•æ—¥å¿—

\- æ”¯æŒæ’¤é”€/é‡åš



\#### 2.3 BPæ§åˆ¶é¢æ¿ (BP Control)

\*\*è·¯ç”±\*\*: `/admin/bp-control`



\*\*åŠŸèƒ½éœ€æ±‚\*\*:

\- åœ°å›¾æ± ç®¡ç†

\- Banæ“ä½œ

\- Pickæ“ä½œ

\- å€’è®¡æ—¶æ§åˆ¶

\- å½“å‰é˜Ÿä¼åˆ‡æ¢

\- BPæµç¨‹é¢„è®¾åŠ è½½

\- é‡ç½®BPæµç¨‹



\*\*é¢„è®¾æ–¹æ¡ˆ\*\*:

\- BO1æµç¨‹

\- BO3æµç¨‹

\- BO5æµç¨‹

\- è‡ªå®šä¹‰æµç¨‹



\#### 2.4 åœºæ™¯åˆ‡æ¢å™¨ (Scene Switcher)

\*\*è·¯ç”±\*\*: `/admin/scenes`



\*\*åŠŸèƒ½éœ€æ±‚\*\*:

\- é¢„è®¾åœºæ™¯ç®¡ç†

&nbsp; - å¼€åœºåœºæ™¯

&nbsp; - BPåœºæ™¯

&nbsp; - æ¯”èµ›ä¸­åœºæ™¯

&nbsp; - ä¸­åœºä¼‘æ¯åœºæ™¯

&nbsp; - ç»“æŸåœºæ™¯

\- ä¸€é”®åˆ‡æ¢overlayç»„åˆ

\- åœºæ™¯ç¼–è¾‘å™¨



\#### 2.5 Overlayå¼€å…³æ§åˆ¶

\*\*è·¯ç”±\*\*: `/admin/overlay-toggle`



\*\*åŠŸèƒ½éœ€æ±‚\*\*:

\- æ‰€æœ‰overlayæ˜¾ç¤º/éšè—å¼€å…³

\- é€æ˜åº¦æ§åˆ¶

\- ä½ç½®å¾®è°ƒï¼ˆå¯é€‰ï¼‰



\### 3. æ•°æ®ç®¡ç†æ¨¡å—



\#### 3.1 é˜Ÿä¼ç®¡ç†

\- CRUDæ“ä½œ

\- Logoä¸Šä¼ 

\- å†å²æ•°æ®



\#### 3.2 é€‰æ‰‹ç®¡ç†

\- é€‰æ‰‹ä¿¡æ¯

\- ç»Ÿè®¡æ•°æ®

\- å¤´åƒç®¡ç†



\#### 3.3 èµ›äº‹ç®¡ç†

\- èµ›äº‹åˆ›å»º

\- èµ›ç¨‹å®‰æ’

\- å¯¹é˜µé…ç½®



---



\## å¼€å‘è®¡åˆ’



\### é˜¶æ®µåˆ’åˆ†ï¼ˆ8å‘¨è®¡åˆ’ï¼‰



\#### Week 1: åŸºç¡€æ­å»º (2025-02-03 ~ 02-09)



\*\*Day 1-2: é¡¹ç›®åˆå§‹åŒ–\*\*

\- \[ ] åˆ›å»ºGitä»“åº“

\- \[ ] å‰ç«¯é¡¹ç›®æ­å»º (Next.js)

\- \[ ] åç«¯é¡¹ç›®æ­å»º (Express)

\- \[ ] Dockerç¯å¢ƒé…ç½®

\- \[ ] æ•°æ®åº“è®¾è®¡



\*\*äº¤ä»˜ç‰©\*\*:

\- é¡¹ç›®è„šæ‰‹æ¶

\- å¼€å‘ç¯å¢ƒæ–‡æ¡£

\- æ•°æ®åº“Schema



\*\*Day 3-4: WebSocketåŸºç¡€\*\*

\- \[ ] åç«¯Socket.ioæœåŠ¡

\- \[ ] å‰ç«¯Socketè¿æ¥

\- \[ ] äº‹ä»¶å®šä¹‰

\- \[ ] å¿ƒè·³æ£€æµ‹

\- \[ ] æ–­çº¿é‡è¿æœºåˆ¶



\*\*äº¤ä»˜ç‰©\*\*:

\- WebSocketé€šä¿¡Demo

\- äº‹ä»¶æ–‡æ¡£



\*\*Day 5-7: æ•°æ®ç»“æ„è®¾è®¡\*\*

\- \[ ] TypeScriptç±»å‹å®šä¹‰

\- \[ ] æ•°æ®æ¨¡å‹è®¾è®¡

\- \[ ] APIæ¥å£å®šä¹‰

\- \[ ] çŠ¶æ€ç®¡ç†æ¶æ„



\*\*äº¤ä»˜ç‰©\*\*:

\- å®Œæ•´ç±»å‹å®šä¹‰æ–‡ä»¶

\- APIæ–‡æ¡£v1.0



---



\#### Week 2: æ ¸å¿ƒOverlay (2025-02-10 ~ 02-16)



\*\*Day 8-10: æ¯”åˆ†æ¿å¼€å‘\*\*

\- \[ ] UIç»„ä»¶å¼€å‘

\- \[ ] WebSocketé›†æˆ

\- \[ ] åŠ¨ç”»å®ç°

\- \[ ] OBSæµ‹è¯•



\*\*äº¤ä»˜ç‰©\*\*:

\- å¯ç”¨çš„æ¯”åˆ†æ¿Overlay

\- OBSé…ç½®æ–‡æ¡£



\*\*Day 11-14: BPç³»ç»Ÿå¼€å‘\*\*

\- \[ ] BP UIè®¾è®¡å®ç°

\- \[ ] Ban/Pické€»è¾‘

\- \[ ] å€’è®¡æ—¶åŠŸèƒ½

\- \[ ] æµç¨‹çŠ¶æ€æœº

\- \[ ] åŠ¨ç”»æ•ˆæœ



\*\*äº¤ä»˜ç‰©\*\*:

\- å®Œæ•´BPç³»ç»Ÿ

\- BPæµç¨‹æµ‹è¯•æŠ¥å‘Š



---



\#### Week 3: æ§åˆ¶é¢æ¿ (2025-02-17 ~ 02-23)



\*\*Day 15-17: ä¸»æ§åˆ¶å°\*\*

\- \[ ] Dashboardå¸ƒå±€

\- \[ ] æ¯”åˆ†æ§åˆ¶ç»„ä»¶

\- \[ ] é˜Ÿä¼ç®¡ç†ç•Œé¢

\- \[ ] WebSocketå‘é€



\*\*Day 18-19: BPæ§åˆ¶é¢æ¿\*\*

\- \[ ] BPæ“ä½œç•Œé¢

\- \[ ] é¢„è®¾æ–¹æ¡ˆç®¡ç†

\- \[ ] æ’¤é”€/é‡åšåŠŸèƒ½



\*\*Day 20-21: åœºæ™¯åˆ‡æ¢\*\*

\- \[ ] åœºæ™¯ç®¡ç†å™¨

\- \[ ] é¢„è®¾åœºæ™¯é…ç½®

\- \[ ] ä¸€é”®åˆ‡æ¢åŠŸèƒ½



\*\*äº¤ä»˜ç‰©\*\*:

\- å®Œæ•´æ§åˆ¶é¢æ¿

\- æ“ä½œæ‰‹å†Œv1.0



---



\#### Week 4: æ‰©å±•åŠŸèƒ½ (2025-02-24 ~ 03-02)



\*\*Day 22-23: é€‰æ‰‹ä¿¡æ¯æ¡\*\*

\- \[ ] Lower Thirdç»„ä»¶

\- \[ ] åŠ¨ç”»æ•ˆæœ

\- \[ ] æ•°æ®ç»‘å®š



\*\*Day 24-25: åœ°å›¾Veto\*\*

\- \[ ] Map Veto UI

\- \[ ] æµç¨‹æ§åˆ¶

\- \[ ] ç»“æœå±•ç¤º



\*\*Day 26-27: è¾…åŠ©Overlay\*\*

\- \[ ] å€’è®¡æ—¶å™¨

\- \[ ] å›æ”¾æ ‡è¯†

\- \[ ] ä¸­åœºä¼‘æ¯ç”»é¢

\- \[ ] èµåŠ©å•†å±•ç¤º



\*\*Day 28: é›†æˆæµ‹è¯•\*\*

\- \[ ] æ‰€æœ‰overlayè”åŠ¨æµ‹è¯•

\- \[ ] æ€§èƒ½æµ‹è¯•

\- \[ ] å…¼å®¹æ€§æµ‹è¯•



\*\*äº¤ä»˜ç‰©\*\*:

\- æ‰€æœ‰Overlayé¡µé¢

\- æµ‹è¯•æŠ¥å‘Š



---



\#### Week 5: è§†è§‰ä¼˜åŒ– (2025-03-03 ~ 03-09)



\*\*Day 29-31: UI/UXæ‰“ç£¨\*\*

\- \[ ] è§†è§‰æ•ˆæœä¼˜åŒ–

\- \[ ] åŠ¨ç”»æµç•…åº¦è°ƒæ•´

\- \[ ] å­—ä½“å’Œæ’ç‰ˆ



\*\*Day 32-33: ä¸»é¢˜ç³»ç»Ÿ\*\*

\- \[ ] CSSå˜é‡ç³»ç»Ÿ

\- \[ ] ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½

\- \[ ] é¢„è®¾ä¸»é¢˜ï¼ˆ3-5å¥—ï¼‰



\*\*Day 34-35: æ€§èƒ½ä¼˜åŒ–\*\*

\- \[ ] ç»„ä»¶æ‡’åŠ è½½

\- \[ ] å›¾ç‰‡ä¼˜åŒ–

\- \[ ] WebSocketèŠ‚æµ

\- \[ ] å†…å­˜æ³„æ¼æ£€æŸ¥



\*\*äº¤ä»˜ç‰©\*\*:

\- ä¼˜åŒ–åçš„ç³»ç»Ÿ

\- æ€§èƒ½æµ‹è¯•æŠ¥å‘Š



---



\#### Week 6: ç¨³å®šæ€§ (2025-03-10 ~ 03-16)



\*\*Day 36-38: é”™è¯¯å¤„ç†\*\*

\- \[ ] å¼‚å¸¸æ•è·æœºåˆ¶

\- \[ ] é™çº§æ–¹æ¡ˆ

\- \[ ] é”™è¯¯æ—¥å¿—ç³»ç»Ÿ

\- \[ ] æ•°æ®å¤‡ä»½æ¢å¤



\*\*Day 39-40: éƒ¨ç½²å‡†å¤‡\*\*

\- \[ ] ç”Ÿäº§ç¯å¢ƒé…ç½®

\- \[ ] Dockeré•œåƒæ„å»º

\- \[ ] CI/CDæµç¨‹

\- \[ ] ç›‘æ§å‘Šè­¦



\*\*Day 41-42: æ–‡æ¡£ç¼–å†™\*\*

\- \[ ] ç”¨æˆ·ä½¿ç”¨æ‰‹å†Œ

\- \[ ] éƒ¨ç½²è¿ç»´æ–‡æ¡£

\- \[ ] APIæ–‡æ¡£å®Œå–„

\- \[ ] æ•…éšœæ’æŸ¥æ‰‹å†Œ



\*\*äº¤ä»˜ç‰©\*\*:

\- ç”Ÿäº§å°±ç»ªç‰ˆæœ¬

\- å®Œæ•´æ–‡æ¡£é›†



---



\#### Week 7-8: é«˜çº§åŠŸèƒ½ (2025-03-17 ~ 03-30)



\*\*å¯é€‰åŠŸèƒ½å¼€å‘\*\*:

\- \[ ] æ•°æ®ç»Ÿè®¡é¢æ¿

\- \[ ] å†å²æ•°æ®æŸ¥è¯¢

\- \[ ] è‡ªåŠ¨åŒ–é›†æˆ

\- \[ ] å¤šè¯­è¨€æ”¯æŒ

\- \[ ] éŸ³æ•ˆç³»ç»Ÿ

\- \[ ] ç§»åŠ¨ç«¯æ§åˆ¶ï¼ˆPWAï¼‰



\*\*äº¤ä»˜ç‰©\*\*:

\- åŠŸèƒ½å®Œæ•´çš„ç³»ç»Ÿ

\- v1.0æ­£å¼ç‰ˆæœ¬



---



\### é‡Œç¨‹ç¢‘æ£€æŸ¥ç‚¹



\#### Milestone 1: MVPå®Œæˆ (Week 2ç»“æŸ)

\*\*éªŒæ”¶æ ‡å‡†\*\*:

\- âœ… æ¯”åˆ†æ¿å¯åœ¨OBSä¸­æ­£å¸¸æ˜¾ç¤º

\- âœ… æ§åˆ¶é¢æ¿å¯æ›´æ–°æ¯”åˆ†

\- âœ… WebSocketå®æ—¶åŒæ­¥æ­£å¸¸

\- âœ… åŸºç¡€BPç³»ç»Ÿå¯ç”¨



\*\*æ¼”ç¤ºè¦æ±‚\*\*:

\- æ¨¡æ‹Ÿä¸€åœºBO3æ¯”èµ›å®Œæ•´æµç¨‹



\#### Milestone 2: åŠŸèƒ½å®Œæ•´ (Week 4ç»“æŸ)

\*\*éªŒæ”¶æ ‡å‡†\*\*:

\- âœ… æ‰€æœ‰ä¸»è¦Overlayå®Œæˆ

\- âœ… æ§åˆ¶é¢æ¿åŠŸèƒ½å®Œæ•´

\- âœ… å¯è¿›è¡Œå®Œæ•´èµ›äº‹æ¼”ç»ƒ

\- âœ… åŠ¨ç”»æ•ˆæœæµç•…



\*\*æ¼”ç¤ºè¦æ±‚\*\*:

\- æ¨¡æ‹ŸçœŸå®èµ›äº‹2å°æ—¶ç›´æ’­



\#### Milestone 3: ç”Ÿäº§å°±ç»ª (Week 6ç»“æŸ)

\*\*éªŒæ”¶æ ‡å‡†\*\*:

\- âœ… ç³»ç»Ÿç¨³å®šè¿è¡Œ3å°æ—¶+

\- âœ… æ€§èƒ½è¾¾æ ‡ï¼ˆ60fpsï¼‰

\- âœ… æ–‡æ¡£é½å…¨

\- âœ… éƒ¨ç½²æ–¹æ¡ˆå®Œæ•´



\*\*äº¤ä»˜è¦æ±‚\*\*:

\- å¯ç‹¬ç«‹éƒ¨ç½²ä½¿ç”¨

\- æä¾›åŸ¹è®­ææ–™



---



\## æŠ€æœ¯é€‰å‹



\### å‰ç«¯æŠ€æœ¯æ ˆè¯¦è§£



\#### ä¸ºä»€ä¹ˆé€‰æ‹© Next.js?

1\. \*\*SSRæ”¯æŒ\*\* - é¦–å±åŠ è½½ä¼˜åŒ–

2\. \*\*æ–‡ä»¶è·¯ç”±\*\* - å¤©ç„¶æ”¯æŒå¤šé¡µé¢

3\. \*\*API Routes\*\* - å¯å†…ç½®ç®€å•åç«¯

4\. \*\*ä¼˜ç§€ç”Ÿæ€\*\* - ä¸°å¯Œçš„æ’ä»¶

5\. \*\*å¼€å‘ä½“éªŒ\*\* - çƒ­é‡è½½ã€TypeScriptæ”¯æŒ



\#### ä¸ºä»€ä¹ˆé€‰æ‹© Framer Motion?

1\. \*\*å£°æ˜å¼API\*\* - ä»£ç ç®€æ´

2\. \*\*æ€§èƒ½ä¼˜ç§€\*\* - GPUåŠ é€Ÿ

3\. \*\*æ‰‹åŠ¿æ”¯æŒ\*\* - æ‹–æ‹½ç­‰äº¤äº’

4\. \*\*SpringåŠ¨ç”»\*\* - è‡ªç„¶çš„ç‰©ç†åŠ¨ç”»

5\. \*\*Reacté›†æˆ\*\* - æ— ç¼ä½¿ç”¨



\#### ä¸ºä»€ä¹ˆé€‰æ‹© Zustand?

1\. \*\*è½»é‡çº§\*\* - ä»…1kb

2\. \*\*ç®€å•æ˜“ç”¨\*\* - æ— éœ€Provider

3\. \*\*TypeScriptå‹å¥½\*\* - å®Œç¾ç±»å‹æ¨å¯¼

4\. \*\*DevTools\*\* - è°ƒè¯•æ–¹ä¾¿

5\. \*\*æ€§èƒ½å¥½\*\* - ç»†ç²’åº¦æ›´æ–°



\### åç«¯æŠ€æœ¯æ ˆè¯¦è§£



\#### ä¸ºä»€ä¹ˆé€‰æ‹© Express?

1\. \*\*æˆç†Ÿç¨³å®š\*\* - ä¹…ç»è€ƒéªŒ

2\. \*\*ä¸­é—´ä»¶ä¸°å¯Œ\*\* - ç”Ÿæ€å®Œå–„

3\. \*\*çµæ´»\*\* - é«˜åº¦å¯å®šåˆ¶

4\. \*\*æ–‡æ¡£é½å…¨\*\* - æ˜“å­¦ä¹ 

5\. \*\*ç¤¾åŒºæ´»è·ƒ\*\* - é—®é¢˜è§£å†³å¿«



\#### ä¸ºä»€ä¹ˆé€‰æ‹© Socket.io?

1\. \*\*è‡ªåŠ¨é™çº§\*\* - å…¼å®¹æ€§å¥½

2\. \*\*æˆ¿é—´æœºåˆ¶\*\* - æ˜“å®ç°åˆ†ç»„

3\. \*\*é‡è¿æœºåˆ¶\*\* - ç¨³å®šæ€§é«˜

4\. \*\*äºŒè¿›åˆ¶æ”¯æŒ\*\* - ä¼ è¾“æ•ˆç‡

5\. \*\*åŒå‘é€šä¿¡\*\* - å®æ—¶æ€§å¼º



\### æ•°æ®åº“é€‰æ‹©å»ºè®®



\#### PostgreSQL (æ¨è)

\*\*é€‚ç”¨åœºæ™¯\*\*:

\- éœ€è¦å¤æ‚æŸ¥è¯¢

\- æ•°æ®å…³ç³»å¤æ‚

\- ACIDè¦æ±‚é«˜



\*\*ä¼˜åŠ¿\*\*:

\- åŠŸèƒ½å¼ºå¤§

\- æ‰©å±•æ€§å¥½

\- å¼€æºå…è´¹



\#### MongoDB

\*\*é€‚ç”¨åœºæ™¯\*\*:

\- æ•°æ®ç»“æ„çµæ´»

\- å¿«é€Ÿè¿­ä»£

\- æ¨ªå‘æ‰©å±•éœ€æ±‚



\*\*ä¼˜åŠ¿\*\*:

\- Schemaçµæ´»

\- æŸ¥è¯¢ç®€å•

\- æ˜“äºä¸Šæ‰‹



---



\## ç³»ç»Ÿè®¾è®¡



\### æ•°æ®æ¨¡å‹è®¾è®¡



\#### æ ¸å¿ƒå®ä½“



```typescript

// Match - æ¯”èµ›

interface Match {

&nbsp; id: string;

&nbsp; eventId: string;           // å…³è”èµ›äº‹

&nbsp; teamA: Team;

&nbsp; teamB: Team;

&nbsp; format: 'BO1' | 'BO3' | 'BO5';

&nbsp; currentMap: number;        // å½“å‰ç¬¬å‡ å¼ å›¾

&nbsp; maps: Map\[];

&nbsp; status: 'upcoming' | 'live' | 'finished';

&nbsp; startTime: Date;

&nbsp; endTime?: Date;

&nbsp; createdAt: Date;

&nbsp; updatedAt: Date;

}



// Team - é˜Ÿä¼

interface Team {

&nbsp; id: string;

&nbsp; name: string;

&nbsp; shortName: string;         // ç¼©å†™ï¼ˆ3-4å­—ç¬¦ï¼‰

&nbsp; logo: string;              // Logo URL

&nbsp; country: string;

&nbsp; players: Player\[];

&nbsp; score: number;             // å½“å‰æ¯”åˆ†

&nbsp; economy?: number;          // ç»æµ

&nbsp; createdAt: Date;

&nbsp; updatedAt: Date;

}



// Player - é€‰æ‰‹

interface Player {

&nbsp; id: string;

&nbsp; gameId: string;            // æ¸¸æˆID

&nbsp; realName: string;

&nbsp; country: string;

&nbsp; avatar?: string;

&nbsp; teamId: string;

&nbsp; stats?: PlayerStats;

&nbsp; createdAt: Date;

&nbsp; updatedAt: Date;

}



// PlayerStats - é€‰æ‰‹ç»Ÿè®¡

interface PlayerStats {

&nbsp; kills: number;

&nbsp; deaths: number;

&nbsp; assists: number;

&nbsp; adr: number;              // å¹³å‡ä¼¤å®³

&nbsp; rating: number;           // Rating 2.0

}



// Map - åœ°å›¾

interface Map {

&nbsp; id: string;

&nbsp; matchId: string;

&nbsp; name: string;

&nbsp; order: number;            // ç¬¬å‡ å¼ å›¾

&nbsp; scoreA: number;

&nbsp; scoreB: number;

&nbsp; status: 'upcoming' | 'live' | 'finished';

&nbsp; rounds: Round\[];

&nbsp; winner?: 'A' | 'B';

&nbsp; createdAt: Date;

&nbsp; updatedAt: Date;

}



// Round - å›åˆ

interface Round {

&nbsp; id: string;

&nbsp; mapId: string;

&nbsp; roundNumber: number;

&nbsp; winner: 'A' | 'B';

&nbsp; reason: 'elimination' | 'bomb' | 'time' | 'defuse';

&nbsp; mvp?: string;             // ç©å®¶ID

&nbsp; createdAt: Date;

}



// BPSession - BPä¼šè¯

interface BPSession {

&nbsp; id: string;

&nbsp; matchId: string;

&nbsp; mapPool: string\[];        // åœ°å›¾æ± 

&nbsp; actions: BPAction\[];

&nbsp; currentPhase: 'ban' | 'pick';

&nbsp; activeTeam: 'A' | 'B';

&nbsp; countdown: number;

&nbsp; status: 'active' | 'completed';

&nbsp; createdAt: Date;

&nbsp; updatedAt: Date;

}



// BPAction - BPæ“ä½œ

interface BPAction {

&nbsp; id: string;

&nbsp; sessionId: string;

&nbsp; type: 'ban' | 'pick';

&nbsp; team: 'A' | 'B';

&nbsp; map: string;

&nbsp; order: number;

&nbsp; timestamp: Date;

}



// OverlayState - OverlayçŠ¶æ€

interface OverlayState {

&nbsp; scoreboard: {

&nbsp;   visible: boolean;

&nbsp;   opacity: number;

&nbsp; };

&nbsp; bp: {

&nbsp;   visible: boolean;

&nbsp;   opacity: number;

&nbsp; };

&nbsp; lowerThird: {

&nbsp;   visible: boolean;

&nbsp;   player?: Player;

&nbsp; };

&nbsp; // ... å…¶ä»–overlay

}



// Event - èµ›äº‹

interface Event {

&nbsp; id: string;

&nbsp; name: string;

&nbsp; logo: string;

&nbsp; startDate: Date;

&nbsp; endDate: Date;

&nbsp; format: string;

&nbsp; sponsors: Sponsor\[];

&nbsp; createdAt: Date;

&nbsp; updatedAt: Date;

}



// Sponsor - èµåŠ©å•†

interface Sponsor {

&nbsp; id: string;

&nbsp; name: string;

&nbsp; logo: string;

&nbsp; tier: 'title' | 'main' | 'partner';

&nbsp; displayDuration: number;  // å±•ç¤ºæ—¶é•¿ï¼ˆç§’ï¼‰

}

```



\### WebSocketäº‹ä»¶å®šä¹‰



\#### å®¢æˆ·ç«¯ â†’ æœåŠ¡ç«¯



```typescript

// è¿æ¥äº‹ä»¶

'client:connect' - å®¢æˆ·ç«¯è¿æ¥

'client:disconnect' - å®¢æˆ·ç«¯æ–­å¼€



// æ¯”èµ›æ§åˆ¶

'match:scoreUpdate' - æ›´æ–°æ¯”åˆ†

&nbsp; payload: { team: 'A' | 'B', delta: number }



'match:roundUpdate' - æ›´æ–°å›åˆ

&nbsp; payload: { mapId: string, winner: 'A' | 'B' }



'match:statusChange' - æ¯”èµ›çŠ¶æ€å˜æ›´

&nbsp; payload: { status: MatchStatus }



// BPæ§åˆ¶

'bp:ban' - Banåœ°å›¾

&nbsp; payload: { team: 'A' | 'B', map: string }



'bp:pick' - Pickåœ°å›¾

&nbsp; payload: { team: 'A' | 'B', map: string }



'bp:undo' - æ’¤é”€æ“ä½œ

&nbsp; payload: { actionId: string }



'bp:reset' - é‡ç½®BP

&nbsp; payload: { sessionId: string }



// Overlayæ§åˆ¶

'overlay:toggle' - åˆ‡æ¢æ˜¾ç¤º

&nbsp; payload: { name: string, visible: boolean }



'overlay:scene' - åˆ‡æ¢åœºæ™¯

&nbsp; payload: { sceneId: string }

```



\#### æœåŠ¡ç«¯ â†’ å®¢æˆ·ç«¯



```typescript

// æ•°æ®æ¨é€

'match:update' - æ¯”èµ›æ•°æ®æ›´æ–°

&nbsp; payload: Match



'bp:update' - BPçŠ¶æ€æ›´æ–°

&nbsp; payload: BPSession



'overlay:update' - OverlayçŠ¶æ€æ›´æ–°

&nbsp; payload: OverlayState



'player:statsUpdate' - é€‰æ‰‹æ•°æ®æ›´æ–°

&nbsp; payload: PlayerStats\[]



// ç³»ç»Ÿæ¶ˆæ¯

'system:error' - é”™è¯¯æ¶ˆæ¯

&nbsp; payload: { code: string, message: string }



'system:notification' - é€šçŸ¥æ¶ˆæ¯

&nbsp; payload: { type: 'info' | 'warning' | 'success', message: string }

```



\### APIæ¥å£è®¾è®¡



\#### RESTful API



```typescript

// æ¯”èµ›ç›¸å…³

GET    /api/matches              // è·å–æ¯”èµ›åˆ—è¡¨

GET    /api/matches/:id          // è·å–æ¯”èµ›è¯¦æƒ…

POST   /api/matches              // åˆ›å»ºæ¯”èµ›

PUT    /api/matches/:id          // æ›´æ–°æ¯”èµ›

DELETE /api/matches/:id          // åˆ é™¤æ¯”èµ›



// é˜Ÿä¼ç›¸å…³

GET    /api/teams                // è·å–é˜Ÿä¼åˆ—è¡¨

GET    /api/teams/:id            // è·å–é˜Ÿä¼è¯¦æƒ…

POST   /api/teams                // åˆ›å»ºé˜Ÿä¼

PUT    /api/teams/:id            // æ›´æ–°é˜Ÿä¼

DELETE /api/teams/:id            // åˆ é™¤é˜Ÿä¼



// é€‰æ‰‹ç›¸å…³

GET    /api/players              // è·å–é€‰æ‰‹åˆ—è¡¨

GET    /api/players/:id          // è·å–é€‰æ‰‹è¯¦æƒ…

POST   /api/players              // åˆ›å»ºé€‰æ‰‹

PUT    /api/players/:id          // æ›´æ–°é€‰æ‰‹

DELETE /api/players/:id          // åˆ é™¤é€‰æ‰‹



// BPç›¸å…³

GET    /api/bp/sessions/:matchId // è·å–BPä¼šè¯

POST   /api/bp/sessions          // åˆ›å»ºBPä¼šè¯

PUT    /api/bp/sessions/:id      // æ›´æ–°BPä¼šè¯



// Overlayç›¸å…³

GET    /api/overlay/state        // è·å–å½“å‰çŠ¶æ€

PUT    /api/overlay/state        // æ›´æ–°çŠ¶æ€



// ä¸Šä¼ 

POST   /api/upload/logo          // ä¸Šä¼ Logo

POST   /api/upload/avatar        // ä¸Šä¼ å¤´åƒ

```



\### çŠ¶æ€ç®¡ç†æ¶æ„



\#### Zustand Storeç»“æ„



```typescript

// stores/matchStore.ts

interface MatchStore {

&nbsp; // çŠ¶æ€

&nbsp; currentMatch: Match | null;

&nbsp; matches: Match\[];

&nbsp; loading: boolean;

&nbsp; error: string | null;

&nbsp; 

&nbsp; // Actions

&nbsp; setCurrentMatch: (match: Match) => void;

&nbsp; updateScore: (team: 'A' | 'B', delta: number) => void;

&nbsp; fetchMatches: () => Promise<void>;

&nbsp; createMatch: (data: CreateMatchDTO) => Promise<void>;

}



// stores/bpStore.ts

interface BPStore {

&nbsp; session: BPSession | null;

&nbsp; history: BPAction\[];

&nbsp; 

&nbsp; ban: (team: 'A' | 'B', map: string) => void;

&nbsp; pick: (team: 'A' | 'B', map: string) => void;

&nbsp; undo: () => void;

&nbsp; reset: () => void;

}



// stores/overlayStore.ts

interface OverlayStore {

&nbsp; states: OverlayState;

&nbsp; 

&nbsp; toggle: (name: string, visible: boolean) => void;

&nbsp; setOpacity: (name: string, opacity: number) => void;

&nbsp; switchScene: (sceneId: string) => void;

}



// stores/socketStore.ts

interface SocketStore {

&nbsp; connected: boolean;

&nbsp; socket: Socket | null;

&nbsp; 

&nbsp; connect: () => void;

&nbsp; disconnect: () => void;

&nbsp; emit: (event: string, data: any) => void;

&nbsp; on: (event: string, handler: Function) => void;

}

```



---



\## å®ç°ç»†èŠ‚



\### 1. WebSocketå®æ—¶é€šä¿¡



\#### æœåŠ¡ç«¯å®ç°



```typescript

// server/socket.ts

import { Server } from 'socket.io';

import { Server as HttpServer } from 'http';



export function initializeSocket(httpServer: HttpServer) {

&nbsp; const io = new Server(httpServer, {

&nbsp;   cors: {

&nbsp;     origin: process.env.CORS\_ORIGIN || '\*',

&nbsp;     credentials: true

&nbsp;   },

&nbsp;   pingTimeout: 60000,

&nbsp;   pingInterval: 25000

&nbsp; });



&nbsp; // è¿æ¥å¤„ç†

&nbsp; io.on('connection', (socket) => {

&nbsp;   console.log('Client connected:', socket.id);

&nbsp;   

&nbsp;   // åŠ å…¥æˆ¿é—´

&nbsp;   socket.join('overlay');

&nbsp;   socket.join('admin');

&nbsp;   

&nbsp;   // æ¯”èµ›æ§åˆ¶

&nbsp;   socket.on('match:scoreUpdate', async (data) => {

&nbsp;     try {

&nbsp;       const match = await updateMatchScore(data);

&nbsp;       io.to('overlay').emit('match:update', match);

&nbsp;     } catch (error) {

&nbsp;       socket.emit('system:error', { 

&nbsp;         message: 'Failed to update score' 

&nbsp;       });

&nbsp;     }

&nbsp;   });

&nbsp;   

&nbsp;   // BPæ§åˆ¶

&nbsp;   socket.on('bp:ban', async (data) => {

&nbsp;     try {

&nbsp;       const session = await processBan(data);

&nbsp;       io.to('overlay').emit('bp:update', session);

&nbsp;     } catch (error) {

&nbsp;       socket.emit('system:error', { 

&nbsp;         message: 'Failed to ban map' 

&nbsp;       });

&nbsp;     }

&nbsp;   });

&nbsp;   

&nbsp;   // Overlayæ§åˆ¶

&nbsp;   socket.on('overlay:toggle', (data) => {

&nbsp;     io.to('overlay').emit('overlay:update', data);

&nbsp;   });

&nbsp;   

&nbsp;   // æ–­å¼€å¤„ç†

&nbsp;   socket.on('disconnect', () => {

&nbsp;     console.log('Client disconnected:', socket.id);

&nbsp;   });

&nbsp; });



&nbsp; return io;

}

```



\#### å®¢æˆ·ç«¯å®ç°



```typescript

// lib/socket.ts

import { io, Socket } from 'socket.io-client';



class SocketService {

&nbsp; private socket: Socket | null = null;

&nbsp; private reconnectAttempts = 0;

&nbsp; private maxReconnectAttempts = 5;



&nbsp; connect(url: string) {

&nbsp;   this.socket = io(url, {

&nbsp;     reconnection: true,

&nbsp;     reconnectionDelay: 1000,

&nbsp;     reconnectionDelayMax: 5000,

&nbsp;     reconnectionAttempts: this.maxReconnectAttempts

&nbsp;   });



&nbsp;   this.socket.on('connect', () => {

&nbsp;     console.log('Connected to server');

&nbsp;     this.reconnectAttempts = 0;

&nbsp;   });



&nbsp;   this.socket.on('disconnect', () => {

&nbsp;     console.log('Disconnected from server');

&nbsp;   });



&nbsp;   this.socket.on('connect\_error', (error) => {

&nbsp;     this.reconnectAttempts++;

&nbsp;     console.error('Connection error:', error);

&nbsp;     

&nbsp;     if (this.reconnectAttempts >= this.maxReconnectAttempts) {

&nbsp;       console.error('Max reconnection attempts reached');

&nbsp;       // è§¦å‘é™çº§æ–¹æ¡ˆ

&nbsp;       this.handleConnectionFailure();

&nbsp;     }

&nbsp;   });

&nbsp; }



&nbsp; emit(event: string, data: any) {

&nbsp;   this.socket?.emit(event, data);

&nbsp; }



&nbsp; on(event: string, handler: Function) {

&nbsp;   this.socket?.on(event, handler as any);

&nbsp; }



&nbsp; off(event: string, handler?: Function) {

&nbsp;   this.socket?.off(event, handler as any);

&nbsp; }



&nbsp; disconnect() {

&nbsp;   this.socket?.disconnect();

&nbsp; }



&nbsp; private handleConnectionFailure() {

&nbsp;   // å¯ç”¨æœ¬åœ°ç¼“å­˜

&nbsp;   // æ˜¾ç¤ºç¦»çº¿æç¤º

&nbsp;   // å°è¯•ä½¿ç”¨å¤‡ç”¨æœåŠ¡å™¨

&nbsp; }

}



export const socketService = new SocketService();

```



\### 2. Overlayç»„ä»¶å®ç°



\#### æ¯”åˆ†æ¿ç»„ä»¶



```typescript

// components/overlays/Scoreboard.tsx

'use client';



import { useEffect, useState } from 'react';

import { motion, AnimatePresence } from 'framer-motion';

import { socketService } from '@/lib/socket';

import { Match } from '@/types';



export default function Scoreboard() {

&nbsp; const \[match, setMatch] = useState<Match | null>(null);

&nbsp; const \[visible, setVisible] = useState(true);



&nbsp; useEffect(() => {

&nbsp;   // è¿æ¥Socket

&nbsp;   socketService.connect(process.env.NEXT\_PUBLIC\_SOCKET\_URL!);



&nbsp;   // ç›‘å¬æ¯”èµ›æ›´æ–°

&nbsp;   socketService.on('match:update', (data: Match) => {

&nbsp;     setMatch(data);

&nbsp;   });



&nbsp;   // ç›‘å¬æ˜¾ç¤ºæ§åˆ¶

&nbsp;   socketService.on('overlay:update', (data: any) => {

&nbsp;     if (data.name === 'scoreboard') {

&nbsp;       setVisible(data.visible);

&nbsp;     }

&nbsp;   });



&nbsp;   return () => {

&nbsp;     socketService.off('match:update');

&nbsp;     socketService.off('overlay:update');

&nbsp;   };

&nbsp; }, \[]);



&nbsp; if (!match) return null;



&nbsp; return (

&nbsp;   <AnimatePresence>

&nbsp;     {visible \&\& (

&nbsp;       <motion.div

&nbsp;         className="fixed top-0 left-1/2 -translate-x-1/2 mt-8"

&nbsp;         initial={{ y: -100, opacity: 0 }}

&nbsp;         animate={{ y: 0, opacity: 1 }}

&nbsp;         exit={{ y: -100, opacity: 0 }}

&nbsp;         transition={{ type: 'spring', damping: 20 }}

&nbsp;       >

&nbsp;         <div className="bg-gradient-to-r from-gray-900/90 to-gray-800/90 backdrop-blur-md rounded-lg px-8 py-4 shadow-2xl border border-gray-700/50">

&nbsp;           <div className="flex items-center gap-8">

&nbsp;             {/\* é˜Ÿä¼A \*/}

&nbsp;             <TeamSection 

&nbsp;               team={match.teamA} 

&nbsp;               score={match.teamA.score}

&nbsp;               side="left"

&nbsp;             />

&nbsp;             

&nbsp;             {/\* ä¸­é—´ä¿¡æ¯ \*/}

&nbsp;             <div className="text-center min-w-\[120px]">

&nbsp;               <div className="text-sm text-gray-400 mb-1">

&nbsp;                 {match.currentMap}/{match.format.replace('BO', '')}

&nbsp;               </div>

&nbsp;               <div className="text-2xl font-bold text-white">

&nbsp;                 {match.maps\[match.currentMap - 1]?.name || 'TBD'}

&nbsp;               </div>

&nbsp;             </div>

&nbsp;             

&nbsp;             {/\* é˜Ÿä¼B \*/}

&nbsp;             <TeamSection 

&nbsp;               team={match.teamB} 

&nbsp;               score={match.teamB.score}

&nbsp;               side="right"

&nbsp;             />

&nbsp;           </div>

&nbsp;         </div>

&nbsp;       </motion.div>

&nbsp;     )}

&nbsp;   </AnimatePresence>

&nbsp; );

}



function TeamSection({ team, score, side }: any) {

&nbsp; return (

&nbsp;   <motion.div 

&nbsp;     className={`flex items-center gap-4 ${side === 'right' ? 'flex-row-reverse' : ''}`}

&nbsp;     key={score} // Keyå˜åŒ–è§¦å‘åŠ¨ç”»

&nbsp;     initial={{ scale: 1 }}

&nbsp;     animate={{ scale: \[1, 1.1, 1] }}

&nbsp;     transition={{ duration: 0.3 }}

&nbsp;   >

&nbsp;     <img 

&nbsp;       src={team.logo} 

&nbsp;       alt={team.name}

&nbsp;       className="w-12 h-12 object-contain"

&nbsp;     />

&nbsp;     <div className={side === 'right' ? 'text-right' : ''}>

&nbsp;       <div className="text-xl font-bold text-white">

&nbsp;         {team.shortName}

&nbsp;       </div>

&nbsp;       <div className="text-sm text-gray-400">

&nbsp;         {team.name}

&nbsp;       </div>

&nbsp;     </div>

&nbsp;     <div className="text-4xl font-bold text-white min-w-\[60px] text-center">

&nbsp;       {score}

&nbsp;     </div>

&nbsp;   </motion.div>

&nbsp; );

}

```



\#### BPç³»ç»Ÿç»„ä»¶



```typescript

// components/overlays/BP.tsx

'use client';



import { useEffect, useState } from 'react';

import { motion, AnimatePresence } from 'framer-motion';

import { socketService } from '@/lib/socket';

import { BPSession, BPAction } from '@/types';



const MAP\_POOL = \[

&nbsp; { name: 'Dust2', image: '/maps/dust2.jpg' },

&nbsp; { name: 'Mirage', image: '/maps/mirage.jpg' },

&nbsp; { name: 'Inferno', image: '/maps/inferno.jpg' },

&nbsp; { name: 'Nuke', image: '/maps/nuke.jpg' },

&nbsp; { name: 'Overpass', image: '/maps/overpass.jpg' },

&nbsp; { name: 'Vertigo', image: '/maps/vertigo.jpg' },

&nbsp; { name: 'Ancient', image: '/maps/ancient.jpg' },

];



export default function BP() {

&nbsp; const \[session, setSession] = useState<BPSession | null>(null);

&nbsp; const \[visible, setVisible] = useState(false);



&nbsp; useEffect(() => {

&nbsp;   socketService.on('bp:update', (data: BPSession) => {

&nbsp;     setSession(data);

&nbsp;   });



&nbsp;   socketService.on('overlay:update', (data: any) => {

&nbsp;     if (data.name === 'bp') {

&nbsp;       setVisible(data.visible);

&nbsp;     }

&nbsp;   });



&nbsp;   return () => {

&nbsp;     socketService.off('bp:update');

&nbsp;     socketService.off('overlay:update');

&nbsp;   };

&nbsp; }, \[]);



&nbsp; if (!visible || !session) return null;



&nbsp; const getMapStatus = (mapName: string) => {

&nbsp;   const action = session.actions.find(a => a.map === mapName);

&nbsp;   return action || null;

&nbsp; };



&nbsp; return (

&nbsp;   <motion.div

&nbsp;     className="fixed inset-0 flex items-center justify-center"

&nbsp;     initial={{ opacity: 0 }}

&nbsp;     animate={{ opacity: 1 }}

&nbsp;     exit={{ opacity: 0 }}

&nbsp;   >

&nbsp;     <div className="bg-gray-900/95 backdrop-blur-md rounded-2xl p-12 shadow-2xl">

&nbsp;       <h2 className="text-4xl font-bold text-white text-center mb-8">

&nbsp;         Map Veto

&nbsp;       </h2>

&nbsp;       

&nbsp;       <div className="grid grid-cols-4 gap-6">

&nbsp;         {MAP\_POOL.map((map, index) => {

&nbsp;           const status = getMapStatus(map.name);

&nbsp;           return (

&nbsp;             <MapCard 

&nbsp;               key={map.name}

&nbsp;               map={map}

&nbsp;               status={status}

&nbsp;               index={index}

&nbsp;             />

&nbsp;           );

&nbsp;         })}

&nbsp;       </div>



&nbsp;       {/\* å½“å‰æ“ä½œæç¤º \*/}

&nbsp;       <motion.div 

&nbsp;         className="mt-8 text-center"

&nbsp;         key={session.activeTeam + session.currentPhase}

&nbsp;         initial={{ y: 20, opacity: 0 }}

&nbsp;         animate={{ y: 0, opacity: 1 }}

&nbsp;       >

&nbsp;         <div className="text-2xl text-white">

&nbsp;           Team {session.activeTeam} - {session.currentPhase.toUpperCase()}

&nbsp;         </div>

&nbsp;         {session.countdown > 0 \&\& (

&nbsp;           <div className="text-5xl font-bold text-orange-500 mt-2">

&nbsp;             {session.countdown}s

&nbsp;           </div>

&nbsp;         )}

&nbsp;       </motion.div>

&nbsp;     </div>

&nbsp;   </motion.div>

&nbsp; );

}



function MapCard({ map, status, index }: any) {

&nbsp; const isBanned = status?.type === 'ban';

&nbsp; const isPicked = status?.type === 'pick';



&nbsp; return (

&nbsp;   <motion.div

&nbsp;     className="relative overflow-hidden rounded-lg aspect-video"

&nbsp;     initial={{ opacity: 0, y: 50 }}

&nbsp;     animate={{ opacity: 1, y: 0 }}

&nbsp;     transition={{ delay: index \* 0.1 }}

&nbsp;   >

&nbsp;     <img 

&nbsp;       src={map.image} 

&nbsp;       alt={map.name}

&nbsp;       className={`w-full h-full object-cover transition-all ${

&nbsp;         isBanned ? 'grayscale brightness-50' : ''

&nbsp;       }`}

&nbsp;     />

&nbsp;     

&nbsp;     {/\* åœ°å›¾åç§° \*/}

&nbsp;     <div className="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/90 to-transparent p-4">

&nbsp;       <div className="text-xl font-bold text-white">

&nbsp;         {map.name}

&nbsp;       </div>

&nbsp;     </div>



&nbsp;     {/\* Ban/Pickæ ‡è®° \*/}

&nbsp;     <AnimatePresence>

&nbsp;       {status \&\& (

&nbsp;         <motion.div

&nbsp;           className={`absolute inset-0 flex items-center justify-center ${

&nbsp;             isBanned ? 'bg-red-500/80' : 'bg-green-500/80'

&nbsp;           }`}

&nbsp;           initial={{ scale: 0 }}

&nbsp;           animate={{ scale: 1 }}

&nbsp;           exit={{ scale: 0 }}

&nbsp;         >

&nbsp;           <div className="text-6xl font-bold text-white">

&nbsp;             {isBanned ? 'BANNED' : 'PICKED'}

&nbsp;           </div>

&nbsp;           <div className="absolute bottom-4 text-2xl text-white">

&nbsp;             Team {status.team}

&nbsp;           </div>

&nbsp;         </motion.div>

&nbsp;       )}

&nbsp;     </AnimatePresence>

&nbsp;   </motion.div>

&nbsp; );

}

```



\### 3. æ§åˆ¶é¢æ¿å®ç°



\#### æ¯”èµ›æ§åˆ¶ç»„ä»¶



```typescript

// app/admin/match-control/page.tsx

'use client';



import { useState } from 'react';

import { socketService } from '@/lib/socket';

import { Match } from '@/types';



export default function MatchControl() {

&nbsp; const \[match, setMatch] = useState<Match | null>(null);



&nbsp; const updateScore = (team: 'A' | 'B', delta: number) => {

&nbsp;   socketService.emit('match:scoreUpdate', { team, delta });

&nbsp; };



&nbsp; const resetMatch = () => {

&nbsp;   if (confirm('ç¡®å®šè¦é‡ç½®æ¯”èµ›å—ï¼Ÿ')) {

&nbsp;     socketService.emit('match:reset', { matchId: match?.id });

&nbsp;   }

&nbsp; };



&nbsp; return (

&nbsp;   <div className="p-8">

&nbsp;     <h1 className="text-3xl font-bold mb-8">æ¯”èµ›æ§åˆ¶</h1>

&nbsp;     

&nbsp;     {/\* æ¯”åˆ†æ§åˆ¶ \*/}

&nbsp;     <div className="grid grid-cols-2 gap-8 mb-8">

&nbsp;       <ScoreControl 

&nbsp;         team={match?.teamA}

&nbsp;         side="A"

&nbsp;         onUpdate={updateScore}

&nbsp;       />

&nbsp;       <ScoreControl 

&nbsp;         team={match?.teamB}

&nbsp;         side="B"

&nbsp;         onUpdate={updateScore}

&nbsp;       />

&nbsp;     </div>



&nbsp;     {/\* åœ°å›¾æ§åˆ¶ \*/}

&nbsp;     <div className="bg-white rounded-lg p-6 shadow mb-8">

&nbsp;       <h2 className="text-xl font-bold mb-4">åœ°å›¾æ§åˆ¶</h2>

&nbsp;       <div className="grid grid-cols-7 gap-4">

&nbsp;         {MAP\_POOL.map(map => (

&nbsp;           <button

&nbsp;             key={map.name}

&nbsp;             onClick={() => selectMap(map.name)}

&nbsp;             className="p-4 border rounded hover:bg-gray-50"

&nbsp;           >

&nbsp;             <img src={map.image} className="w-full mb-2" />

&nbsp;             <div className="text-sm">{map.name}</div>

&nbsp;           </button>

&nbsp;         ))}

&nbsp;       </div>

&nbsp;     </div>



&nbsp;     {/\* å¿«æ·æ“ä½œ \*/}

&nbsp;     <div className="flex gap-4">

&nbsp;       <button

&nbsp;         onClick={resetMatch}

&nbsp;         className="px-6 py-3 bg-red-500 text-white rounded hover:bg-red-600"

&nbsp;       >

&nbsp;         é‡ç½®æ¯”èµ›

&nbsp;       </button>

&nbsp;       <button

&nbsp;         onClick={() => socketService.emit('match:pause')}

&nbsp;         className="px-6 py-3 bg-yellow-500 text-white rounded hover:bg-yellow-600"

&nbsp;       >

&nbsp;         æš‚åœ

&nbsp;       </button>

&nbsp;     </div>

&nbsp;   </div>

&nbsp; );

}



function ScoreControl({ team, side, onUpdate }: any) {

&nbsp; return (

&nbsp;   <div className="bg-white rounded-lg p-6 shadow">

&nbsp;     <div className="flex items-center gap-4 mb-4">

&nbsp;       <img src={team?.logo} className="w-16 h-16" />

&nbsp;       <div>

&nbsp;         <div className="text-2xl font-bold">{team?.name}</div>

&nbsp;         <div className="text-gray-500">{team?.shortName}</div>

&nbsp;       </div>

&nbsp;     </div>

&nbsp;     

&nbsp;     <div className="flex items-center gap-4">

&nbsp;       <button

&nbsp;         onClick={() => onUpdate(side, -1)}

&nbsp;         className="px-6 py-3 bg-red-500 text-white rounded text-2xl font-bold hover:bg-red-600"

&nbsp;       >

&nbsp;         -1

&nbsp;       </button>

&nbsp;       

&nbsp;       <div className="text-6xl font-bold flex-1 text-center">

&nbsp;         {team?.score || 0}

&nbsp;       </div>

&nbsp;       

&nbsp;       <button

&nbsp;         onClick={() => onUpdate(side, 1)}

&nbsp;         className="px-6 py-3 bg-green-500 text-white rounded text-2xl font-bold hover:bg-green-600"

&nbsp;       >

&nbsp;         +1

&nbsp;       </button>

&nbsp;     </div>

&nbsp;   </div>

&nbsp; );

}

```



\### 4. æ•°æ®æŒä¹…åŒ–



\#### Prisma Schema



```prisma

// prisma/schema.prisma

generator client {

&nbsp; provider = "prisma-client-js"

}



datasource db {

&nbsp; provider = "postgresql"

&nbsp; url      = env("DATABASE\_URL")

}



model Event {

&nbsp; id        String   @id @default(cuid())

&nbsp; name      String

&nbsp; logo      String?

&nbsp; startDate DateTime

&nbsp; endDate   DateTime

&nbsp; format    String

&nbsp; createdAt DateTime @default(now())

&nbsp; updatedAt DateTime @updatedAt

&nbsp; 

&nbsp; matches   Match\[]

&nbsp; sponsors  Sponsor\[]

}



model Team {

&nbsp; id         String   @id @default(cuid())

&nbsp; name       String

&nbsp; shortName  String

&nbsp; logo       String?

&nbsp; country    String

&nbsp; createdAt  DateTime @default(now())

&nbsp; updatedAt  DateTime @updatedAt

&nbsp; 

&nbsp; players    Player\[]

&nbsp; matchesA   Match\[]  @relation("TeamA")

&nbsp; matchesB   Match\[]  @relation("TeamB")

}



model Player {

&nbsp; id        String   @id @default(cuid())

&nbsp; gameId    String   @unique

&nbsp; realName  String

&nbsp; country   String

&nbsp; avatar    String?

&nbsp; teamId    String

&nbsp; createdAt DateTime @default(now())

&nbsp; updatedAt DateTime @updatedAt

&nbsp; 

&nbsp; team      Team     @relation(fields: \[teamId], references: \[id])

}



model Match {

&nbsp; id          String      @id @default(cuid())

&nbsp; eventId     String

&nbsp; teamAId     String

&nbsp; teamBId     String

&nbsp; format      String

&nbsp; currentMap  Int         @default(1)

&nbsp; status      String      @default("upcoming")

&nbsp; startTime   DateTime

&nbsp; endTime     DateTime?

&nbsp; createdAt   DateTime    @default(now())

&nbsp; updatedAt   DateTime    @updatedAt

&nbsp; 

&nbsp; event       Event       @relation(fields: \[eventId], references: \[id])

&nbsp; teamA       Team        @relation("TeamA", fields: \[teamAId], references: \[id])

&nbsp; teamB       Team        @relation("TeamB", fields: \[teamBId], references: \[id])

&nbsp; maps        Map\[]

&nbsp; bpSessions  BPSession\[]

}



model Map {

&nbsp; id        String   @id @default(cuid())

&nbsp; matchId   String

&nbsp; name      String

&nbsp; order     Int

&nbsp; scoreA    Int      @default(0)

&nbsp; scoreB    Int      @default(0)

&nbsp; status    String   @default("upcoming")

&nbsp; winner    String?

&nbsp; createdAt DateTime @default(now())

&nbsp; updatedAt DateTime @updatedAt

&nbsp; 

&nbsp; match     Match    @relation(fields: \[matchId], references: \[id])

&nbsp; rounds    Round\[]

}



model Round {

&nbsp; id          String   @id @default(cuid())

&nbsp; mapId       String

&nbsp; roundNumber Int

&nbsp; winner      String

&nbsp; reason      String

&nbsp; mvp         String?

&nbsp; createdAt   DateTime @default(now())

&nbsp; 

&nbsp; map         Map      @relation(fields: \[mapId], references: \[id])

}



model BPSession {

&nbsp; id           String     @id @default(cuid())

&nbsp; matchId      String

&nbsp; mapPool      String\[]

&nbsp; currentPhase String     @default("ban")

&nbsp; activeTeam   String     @default("A")

&nbsp; countdown    Int        @default(0)

&nbsp; status       String     @default("active")

&nbsp; createdAt    DateTime   @default(now())

&nbsp; updatedAt    DateTime   @updatedAt

&nbsp; 

&nbsp; match        Match      @relation(fields: \[matchId], references: \[id])

&nbsp; actions      BPAction\[]

}



model BPAction {

&nbsp; id        String   @id @default(cuid())

&nbsp; sessionId String

&nbsp; type      String

&nbsp; team      String

&nbsp; map       String

&nbsp; order     Int

&nbsp; createdAt DateTime @default(now())

&nbsp; 

&nbsp; session   BPSession @relation(fields: \[sessionId], references: \[id])

}



model Sponsor {

&nbsp; id              String  @id @default(cuid())

&nbsp; eventId         String

&nbsp; name            String

&nbsp; logo            String

&nbsp; tier            String

&nbsp; displayDuration Int     @default(5)

&nbsp; 

&nbsp; event           Event   @relation(fields: \[eventId], references: \[id])

}

```



\### 5. é”™è¯¯å¤„ç†ä¸é™çº§æ–¹æ¡ˆ



\#### æ–­çº¿é‡è¿



```typescript

// lib/reconnection.ts

import { socketService } from './socket';



class ReconnectionManager {

&nbsp; private reconnectAttempts = 0;

&nbsp; private maxAttempts = 5;

&nbsp; private backupData: any = null;



&nbsp; async handleDisconnection() {

&nbsp;   // ä¿å­˜å½“å‰çŠ¶æ€åˆ°æœ¬åœ°

&nbsp;   this.saveToLocalStorage();

&nbsp;   

&nbsp;   // å°è¯•é‡è¿

&nbsp;   while (this.reconnectAttempts < this.maxAttempts) {

&nbsp;     await this.sleep(this.getBackoffDelay());

&nbsp;     

&nbsp;     try {

&nbsp;       await socketService.connect(process.env.NEXT\_PUBLIC\_SOCKET\_URL!);

&nbsp;       this.reconnectAttempts = 0;

&nbsp;       this.restoreFromLocalStorage();

&nbsp;       return true;

&nbsp;     } catch (error) {

&nbsp;       this.reconnectAttempts++;

&nbsp;     }

&nbsp;   }

&nbsp;   

&nbsp;   // è¿æ¥å¤±è´¥ï¼Œå¯ç”¨ç¦»çº¿æ¨¡å¼

&nbsp;   this.enableOfflineMode();

&nbsp;   return false;

&nbsp; }



&nbsp; private getBackoffDelay() {

&nbsp;   // æŒ‡æ•°é€€é¿ç®—æ³•

&nbsp;   return Math.min(1000 \* Math.pow(2, this.reconnectAttempts), 30000);

&nbsp; }



&nbsp; private saveToLocalStorage() {

&nbsp;   const state = {

&nbsp;     match: store.getState().match,

&nbsp;     bp: store.getState().bp,

&nbsp;     timestamp: Date.now()

&nbsp;   };

&nbsp;   localStorage.setItem('backup-state', JSON.stringify(state));

&nbsp; }



&nbsp; private restoreFromLocalStorage() {

&nbsp;   const backup = localStorage.getItem('backup-state');

&nbsp;   if (backup) {

&nbsp;     const state = JSON.parse(backup);

&nbsp;     // æ£€æŸ¥æ•°æ®æ˜¯å¦è¿‡æœŸï¼ˆ5åˆ†é’Ÿï¼‰

&nbsp;     if (Date.now() - state.timestamp < 5 \* 60 \* 1000) {

&nbsp;       store.setState(state);

&nbsp;     }

&nbsp;   }

&nbsp; }



&nbsp; private enableOfflineMode() {

&nbsp;   // æ˜¾ç¤ºç¦»çº¿æç¤º

&nbsp;   toast.error('æœåŠ¡å™¨è¿æ¥å¤±è´¥ï¼Œå·²è¿›å…¥ç¦»çº¿æ¨¡å¼');

&nbsp;   

&nbsp;   // ç¦ç”¨å®æ—¶åŠŸèƒ½

&nbsp;   store.setState({ offlineMode: true });

&nbsp; }



&nbsp; private sleep(ms: number) {

&nbsp;   return new Promise(resolve => setTimeout(resolve, ms));

&nbsp; }

}



export const reconnectionManager = new ReconnectionManager();

```



\#### æ•°æ®æ ¡éªŒ



```typescript

// lib/validation.ts

import { z } from 'zod';



// Matchæ•°æ®æ ¡éªŒ

export const MatchSchema = z.object({

&nbsp; id: z.string(),

&nbsp; teamA: z.object({

&nbsp;   id: z.string(),

&nbsp;   name: z.string(),

&nbsp;   score: z.number().min(0)

&nbsp; }),

&nbsp; teamB: z.object({

&nbsp;   id: z.string(),

&nbsp;   name: z.string(),

&nbsp;   score: z.number().min(0)

&nbsp; }),

&nbsp; format: z.enum(\['BO1', 'BO3', 'BO5']),

&nbsp; currentMap: z.number().min(1),

&nbsp; status: z.enum(\['upcoming', 'live', 'finished'])

});



// BPæ•°æ®æ ¡éªŒ

export const BPSessionSchema = z.object({

&nbsp; id: z.string(),

&nbsp; matchId: z.string(),

&nbsp; mapPool: z.array(z.string()).length(7),

&nbsp; actions: z.array(z.object({

&nbsp;   type: z.enum(\['ban', 'pick']),

&nbsp;   team: z.enum(\['A', 'B']),

&nbsp;   map: z.string()

&nbsp; })),

&nbsp; currentPhase: z.enum(\['ban', 'pick']),

&nbsp; activeTeam: z.enum(\['A', 'B'])

});



// æ•°æ®æ ¡éªŒä¸­é—´ä»¶

export function validateData<T>(schema: z.ZodSchema<T>, data: any): T {

&nbsp; try {

&nbsp;   return schema.parse(data);

&nbsp; } catch (error) {

&nbsp;   console.error('Data validation failed:', error);

&nbsp;   throw new Error('Invalid data format');

&nbsp; }

}

```



---



\## éƒ¨ç½²æŒ‡å—



\### Dockeréƒ¨ç½²



\#### Dockerfile



```dockerfile

\# Frontend Dockerfile

FROM node:18-alpine AS base



\# Dependencies

FROM base AS deps

WORKDIR /app

COPY package.json package-lock.json ./

RUN npm ci



\# Builder

FROM base AS builder

WORKDIR /app

COPY --from=deps /app/node\_modules ./node\_modules

COPY . .

RUN npm run build



\# Runner

FROM base AS runner

WORKDIR /app

ENV NODE\_ENV production



RUN addgroup --system --gid 1001 nodejs

RUN adduser --system --uid 1001 nextjs



COPY --from=builder /app/public ./public

COPY --from=builder --chown=nextjs:nodejs /app/.next/standalone ./

COPY --from=builder --chown=nextjs:nodejs /app/.next/static ./.next/static



USER nextjs



EXPOSE 3000

ENV PORT 3000



CMD \["node", "server.js"]

```



```dockerfile

\# Backend Dockerfile

FROM node:18-alpine



WORKDIR /app



COPY package\*.json ./

RUN npm ci --only=production



COPY . .

RUN npm run build



EXPOSE 3001



CMD \["node", "dist/index.js"]

```



\#### Docker Compose



```yaml

\# docker-compose.yml

version: '3.8'



services:

&nbsp; frontend:

&nbsp;   build:

&nbsp;     context: ./frontend

&nbsp;     dockerfile: Dockerfile

&nbsp;   ports:

&nbsp;     - "3000:3000"

&nbsp;   environment:

&nbsp;     - NEXT\_PUBLIC\_SOCKET\_URL=http://backend:3001

&nbsp;   depends\_on:

&nbsp;     - backend

&nbsp;   networks:

&nbsp;     - app-network



&nbsp; backend:

&nbsp;   build:

&nbsp;     context: ./backend

&nbsp;     dockerfile: Dockerfile

&nbsp;   ports:

&nbsp;     - "3001:3001"

&nbsp;   environment:

&nbsp;     - DATABASE\_URL=postgresql://user:password@postgres:5432/cs2overlay

&nbsp;     - REDIS\_URL=redis://redis:6379

&nbsp;   depends\_on:

&nbsp;     - postgres

&nbsp;     - redis

&nbsp;   networks:

&nbsp;     - app-network



&nbsp; postgres:

&nbsp;   image: postgres:15-alpine

&nbsp;   environment:

&nbsp;     - POSTGRES\_USER=user

&nbsp;     - POSTGRES\_PASSWORD=password

&nbsp;     - POSTGRES\_DB=cs2overlay

&nbsp;   volumes:

&nbsp;     - postgres-data:/var/lib/postgresql/data

&nbsp;   networks:

&nbsp;     - app-network



&nbsp; redis:

&nbsp;   image: redis:7-alpine

&nbsp;   volumes:

&nbsp;     - redis-data:/data

&nbsp;   networks:

&nbsp;     - app-network



&nbsp; nginx:

&nbsp;   image: nginx:alpine

&nbsp;   ports:

&nbsp;     - "80:80"

&nbsp;     - "443:443"

&nbsp;   volumes:

&nbsp;     - ./nginx.conf:/etc/nginx/nginx.conf:ro

&nbsp;     - ./ssl:/etc/nginx/ssl:ro

&nbsp;   depends\_on:

&nbsp;     - frontend

&nbsp;     - backend

&nbsp;   networks:

&nbsp;     - app-network



networks:

&nbsp; app-network:

&nbsp;   driver: bridge



volumes:

&nbsp; postgres-data:

&nbsp; redis-data:

```



\### Nginxé…ç½®



```nginx

\# nginx.conf

upstream frontend {

&nbsp; server frontend:3000;

}



upstream backend {

&nbsp; server backend:3001;

}



server {

&nbsp; listen 80;

&nbsp; server\_name your-domain.com;

&nbsp; return 301 https://$server\_name$request\_uri;

}



server {

&nbsp; listen 443 ssl http2;

&nbsp; server\_name your-domain.com;



&nbsp; ssl\_certificate /etc/nginx/ssl/cert.pem;

&nbsp; ssl\_certificate\_key /etc/nginx/ssl/key.pem;



&nbsp; # Frontend

&nbsp; location / {

&nbsp;   proxy\_pass http://frontend;

&nbsp;   proxy\_http\_version 1.1;

&nbsp;   proxy\_set\_header Upgrade $http\_upgrade;

&nbsp;   proxy\_set\_header Connection 'upgrade';

&nbsp;   proxy\_set\_header Host $host;

&nbsp;   proxy\_cache\_bypass $http\_upgrade;

&nbsp; }



&nbsp; # Backend API

&nbsp; location /api {

&nbsp;   proxy\_pass http://backend;

&nbsp;   proxy\_http\_version 1.1;

&nbsp;   proxy\_set\_header X-Real-IP $remote\_addr;

&nbsp;   proxy\_set\_header X-Forwarded-For $proxy\_add\_x\_forwarded\_for;

&nbsp;   proxy\_set\_header Host $host;

&nbsp; }



&nbsp; # WebSocket

&nbsp; location /socket.io {

&nbsp;   proxy\_pass http://backend;

&nbsp;   proxy\_http\_version 1.1;

&nbsp;   proxy\_set\_header Upgrade $http\_upgrade;

&nbsp;   proxy\_set\_header Connection "upgrade";

&nbsp;   proxy\_set\_header Host $host;

&nbsp;   proxy\_set\_header X-Real-IP $remote\_addr;

&nbsp;   proxy\_set\_header X-Forwarded-For $proxy\_add\_x\_forwarded\_for;

&nbsp; }

}

```



\### éƒ¨ç½²æ­¥éª¤



```bash

\# 1. å…‹éš†é¡¹ç›®

git clone https://github.com/your-repo/cs2-overlay.git

cd cs2-overlay



\# 2. é…ç½®ç¯å¢ƒå˜é‡

cp .env.example .env

\# ç¼–è¾‘.envæ–‡ä»¶



\# 3. æ„å»ºå¹¶å¯åŠ¨

docker-compose up -d



\# 4. æ£€æŸ¥çŠ¶æ€

docker-compose ps



\# 5. æŸ¥çœ‹æ—¥å¿—

docker-compose logs -f



\# 6. æ•°æ®åº“è¿ç§»

docker-compose exec backend npm run prisma:migrate



\# 7. åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·ï¼ˆå¦‚æœ‰ï¼‰

docker-compose exec backend npm run seed

```



\### æ€§èƒ½ä¼˜åŒ–



\#### å‰ç«¯ä¼˜åŒ–



```typescript

// next.config.js

module.exports = {

&nbsp; compress: true,

&nbsp; images: {

&nbsp;   formats: \['image/webp'],

&nbsp;   deviceSizes: \[640, 750, 828, 1080, 1200, 1920],

&nbsp; },

&nbsp; swcMinify: true,

&nbsp; compiler: {

&nbsp;   removeConsole: process.env.NODE\_ENV === 'production',

&nbsp; },

};

```



\#### ç¼“å­˜ç­–ç•¥



```typescript

// ä½¿ç”¨React Queryç¼“å­˜

import { QueryClient, QueryClientProvider } from '@tanstack/react-query';



const queryClient = new QueryClient({

&nbsp; defaultOptions: {

&nbsp;   queries: {

&nbsp;     staleTime: 5 \* 60 \* 1000, // 5åˆ†é’Ÿ

&nbsp;     cacheTime: 10 \* 60 \* 1000, // 10åˆ†é’Ÿ

&nbsp;     refetchOnWindowFocus: false,

&nbsp;   },

&nbsp; },

});

```



---



\## ä½¿ç”¨æ‰‹å†Œ



\### OBSé…ç½®æŒ‡å—



\#### 1. æ·»åŠ æµè§ˆå™¨æº



1\. åœ¨OBSä¸­å³é”®ç‚¹å‡»åœºæ™¯

2\. é€‰æ‹©"æ·»åŠ " â†’ "æµè§ˆå™¨"

3\. é…ç½®å‚æ•°ï¼š

&nbsp;  - \*\*URL\*\*: `http://localhost:3000/overlay/scoreboard`

&nbsp;  - \*\*å®½åº¦\*\*: 1920

&nbsp;  - \*\*é«˜åº¦\*\*: 1080

&nbsp;  - \*\*FPS\*\*: 60

&nbsp;  - \*\*å‹¾é€‰\*\*: "å½“æºä¸å¯è§æ—¶å…³é—­æº"

&nbsp;  - \*\*è‡ªå®šä¹‰CSS\*\*: 

&nbsp;    ```css

&nbsp;    body { background-color: rgba(0, 0, 0, 0); margin: 0px auto; overflow: hidden; }

&nbsp;    ```



\#### 2. æ¨èåœºæ™¯é…ç½®



\*\*å¼€åœºåœºæ™¯\*\*:

\- æ¸¸æˆç”»é¢

\- æ¯”åˆ†æ¿ (Scoreboard)

\- é¡¶éƒ¨ä¿¡æ¯æ  (Top Bar)



\*\*BPåœºæ™¯\*\*:

\- BPç•Œé¢ (BP)

\- èƒŒæ™¯éŸ³ä¹



\*\*æ¯”èµ›ä¸­åœºæ™¯\*\*:

\- æ¸¸æˆç”»é¢

\- æ¯”åˆ†æ¿

\- é€‰æ‰‹æ‘„åƒå¤´ + è¾¹æ¡†



\*\*ä¸­åœºä¼‘æ¯\*\*:

\- ä¼‘æ¯ç”»é¢ (Break)

\- èµåŠ©å•†å±•ç¤º



\#### 3. å¿«æ·é”®è®¾ç½®



å»ºè®®è®¾ç½®ä»¥ä¸‹å¿«æ·é”®ï¼š

\- F1: æ˜¾ç¤º/éšè—æ¯”åˆ†æ¿

\- F2: æ˜¾ç¤º/éšè—BP

\- F3: æ˜¾ç¤º/éšè—é€‰æ‰‹ä¿¡æ¯

\- F4: åˆ‡æ¢åˆ°æ¯”èµ›åœºæ™¯

\- F5: åˆ‡æ¢åˆ°ä¸­åœºåœºæ™¯



\### æ§åˆ¶é¢æ¿ä½¿ç”¨



\#### æ¯”èµ›å‰å‡†å¤‡



1\. \*\*åˆ›å»ºæ¯”èµ›\*\*

&nbsp;  - è¿›å…¥ `/admin/dashboard`

&nbsp;  - ç‚¹å‡»"æ–°å»ºæ¯”èµ›"

&nbsp;  - å¡«å†™æ¯”èµ›ä¿¡æ¯ï¼ˆé˜Ÿä¼ã€èµ›åˆ¶ç­‰ï¼‰

&nbsp;  - ä¿å­˜



2\. \*\*é…ç½®é˜Ÿä¼ä¿¡æ¯\*\*

&nbsp;  - ä¸Šä¼ é˜Ÿä¼Logo

&nbsp;  - è®¾ç½®é˜Ÿåå’Œç¼©å†™

&nbsp;  - æ·»åŠ é€‰æ‰‹åå•



3\. \*\*è®¾ç½®BPæµç¨‹\*\*

&nbsp;  - é€‰æ‹©èµ›åˆ¶ï¼ˆBO1/BO3/BO5ï¼‰

&nbsp;  - åŠ è½½å¯¹åº”BPæµç¨‹é¢„è®¾



\#### æ¯”èµ›ä¸­æ“ä½œ



1\. \*\*æ§åˆ¶æ¯”åˆ†\*\*

&nbsp;  - ä½¿ç”¨ +1/-1 æŒ‰é’®è°ƒæ•´æ¯”åˆ†

&nbsp;  - æˆ–ç›´æ¥è¾“å…¥åˆ†æ•°



2\. \*\*BPæ“ä½œ\*\*

&nbsp;  - ç‚¹å‡»åœ°å›¾è¿›è¡ŒBan/Pick

&nbsp;  - ç³»ç»Ÿè‡ªåŠ¨åˆ‡æ¢é˜Ÿä¼å’Œé˜¶æ®µ

&nbsp;  - å¯æ’¤é”€ä¸Šä¸€æ­¥æ“ä½œ



3\. \*\*Overlayæ§åˆ¶\*\*

&nbsp;  - ä½¿ç”¨å¼€å…³æ§åˆ¶æ˜¾ç¤º/éšè—

&nbsp;  - åˆ‡æ¢é¢„è®¾åœºæ™¯



\### å¸¸è§é—®é¢˜



\#### Q: Overlayä¸æ˜¾ç¤ºï¼Ÿ

A: æ£€æŸ¥ï¼š

1\. URLæ˜¯å¦æ­£ç¡®

2\. æœåŠ¡æ˜¯å¦è¿è¡Œ

3\. WebSocketæ˜¯å¦è¿æ¥

4\. æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯



\#### Q: åŠ¨ç”»å¡é¡¿ï¼Ÿ

A: å°è¯•ï¼š

1\. é™ä½OBSçš„FPSè®¾ç½®

2\. å‡å°‘åŒæ—¶æ˜¾ç¤ºçš„overlayæ•°é‡

3\. æ£€æŸ¥CPUå ç”¨



\#### Q: WebSocketé¢‘ç¹æ–­å¼€ï¼Ÿ

A: æ£€æŸ¥ï¼š

1\. ç½‘ç»œè¿æ¥

2\. é˜²ç«å¢™è®¾ç½®

3\. æœåŠ¡å™¨è´Ÿè½½

4\. Nginxé…ç½®



---



\## é™„å½•



\### A. æŠ€æœ¯æ ˆå®Œæ•´æ¸…å•



\#### å‰ç«¯ä¾èµ–



```json

{

&nbsp; "dependencies": {

&nbsp;   "next": "14.0.0",

&nbsp;   "react": "18.2.0",

&nbsp;   "react-dom": "18.2.0",

&nbsp;   "typescript": "5.2.0",

&nbsp;   "framer-motion": "10.16.0",

&nbsp;   "socket.io-client": "4.6.0",

&nbsp;   "zustand": "4.4.0",

&nbsp;   "@tanstack/react-query": "5.0.0",

&nbsp;   "tailwindcss": "3.3.0",

&nbsp;   "zod": "3.22.0",

&nbsp;   "date-fns": "2.30.0",

&nbsp;   "recharts": "2.9.0",

&nbsp;   "lucide-react": "0.292.0"

&nbsp; },

&nbsp; "devDependencies": {

&nbsp;   "@types/node": "20.8.0",

&nbsp;   "@types/react": "18.2.0",

&nbsp;   "eslint": "8.51.0",

&nbsp;   "prettier": "3.0.0"

&nbsp; }

}

```



\#### åç«¯ä¾èµ–



```json

{

&nbsp; "dependencies": {

&nbsp;   "express": "4.18.2",

&nbsp;   "socket.io": "4.6.0",

&nbsp;   "prisma": "5.5.0",

&nbsp;   "@prisma/client": "5.5.0",

&nbsp;   "cors": "2.8.5",

&nbsp;   "dotenv": "16.3.1",

&nbsp;   "zod": "3.22.0",

&nbsp;   "bcrypt": "5.1.1",

&nbsp;   "jsonwebtoken": "9.0.2",

&nbsp;   "helmet": "7.1.0",

&nbsp;   "rate-limiter-flexible": "3.0.0"

&nbsp; },

&nbsp; "devDependencies": {

&nbsp;   "@types/express": "4.17.20",

&nbsp;   "@types/cors": "2.8.15",

&nbsp;   "nodemon": "3.0.1",

&nbsp;   "ts-node": "10.9.1"

&nbsp; }

}

```



\### B. Gitå·¥ä½œæµ



\#### åˆ†æ”¯ç­–ç•¥



```

main          - ç”Ÿäº§ç¯å¢ƒ

&nbsp; â””â”€ develop  - å¼€å‘ç¯å¢ƒ

&nbsp;     â”œâ”€ feature/scoreboard

&nbsp;     â”œâ”€ feature/bp-system

&nbsp;     â””â”€ feature/admin-panel

```



\#### Commitè§„èŒƒ



```

feat: æ–°åŠŸèƒ½

fix: ä¿®å¤bug

docs: æ–‡æ¡£æ›´æ–°

style: ä»£ç æ ¼å¼

refactor: é‡æ„

perf: æ€§èƒ½ä¼˜åŒ–

test: æµ‹è¯•

chore: æ„å»º/å·¥å…·



ä¾‹å¦‚ï¼š

feat(overlay): add scoreboard animation

fix(bp): resolve pick order issue

docs: update deployment guide

```



\### C. æµ‹è¯•æ¸…å•



\#### åŠŸèƒ½æµ‹è¯•



\- \[ ] æ¯”åˆ†æ¿æ˜¾ç¤ºæ­£ç¡®

\- \[ ] æ¯”åˆ†æ›´æ–°å®æ—¶åŒæ­¥

\- \[ ] BPæµç¨‹å®Œæ•´å¯ç”¨

\- \[ ] æ‰€æœ‰overlayå¯åˆ‡æ¢

\- \[ ] æ§åˆ¶é¢æ¿åŠŸèƒ½æ­£å¸¸

\- \[ ] æ•°æ®æŒä¹…åŒ–æ­£å¸¸



\#### æ€§èƒ½æµ‹è¯•



\- \[ ] Overlayæ¸²æŸ“60fps

\- \[ ] WebSocketå»¶è¿Ÿ<100ms

\- \[ ] å†…å­˜å ç”¨ç¨³å®š

\- \[ ] é•¿æ—¶é—´è¿è¡Œæ— æ³„æ¼



\#### å…¼å®¹æ€§æµ‹è¯•



\- \[ ] OBS 28+ å…¼å®¹

\- \[ ] Chrome/Edgeæµè§ˆå™¨

\- \[ ] 1920x1080åˆ†è¾¨ç‡

\- \[ ] Windows/Mac/Linux



\### D. èµ„æºé“¾æ¥



\- \*\*OBSå®˜ç½‘\*\*: https://obsproject.com/

\- \*\*Socket.ioæ–‡æ¡£\*\*: https://socket.io/docs/

\- \*\*Framer Motion\*\*: https://www.framer.com/motion/

\- \*\*Next.jsæ–‡æ¡£\*\*: https://nextjs.org/docs

\- \*\*Prismaæ–‡æ¡£\*\*: https://www.prisma.io/docs



\### E. å›¢é˜Ÿåä½œ



\#### è§’è‰²åˆ†å·¥



\- \*\*å‰ç«¯å¼€å‘\*\*: Overlayç»„ä»¶ã€æ§åˆ¶é¢æ¿

\- \*\*åç«¯å¼€å‘\*\*: APIã€WebSocketã€æ•°æ®åº“

\- \*\*UI/UXè®¾è®¡\*\*: ç•Œé¢è®¾è®¡ã€åŠ¨ç”»æ•ˆæœ

\- \*\*æµ‹è¯•\*\*: åŠŸèƒ½æµ‹è¯•ã€æ€§èƒ½æµ‹è¯•

\- \*\*è¿ç»´\*\*: éƒ¨ç½²ã€ç›‘æ§ã€ç»´æŠ¤



\#### æ²Ÿé€šæ¸ é“



\- æ—¥ä¼š: æ¯æ—¥åŒæ­¥è¿›åº¦

\- å‘¨ä¼š: å›é¡¾ä¸è§„åˆ’

\- æ–‡æ¡£: Notion/é£ä¹¦

\- ä»£ç : GitHub PR Review



---



\## ç»“è¯­



æœ¬æ–‡æ¡£æä¾›äº†CS2èµ›äº‹ç›´æ’­Overlayç³»ç»Ÿçš„å®Œæ•´å¼€å‘æŒ‡å—ã€‚å»ºè®®æŒ‰ç…§å¼€å‘è®¡åˆ’å¾ªåºæ¸è¿›ï¼Œå…ˆå®ŒæˆMVPï¼Œå†é€æ­¥æ·»åŠ åŠŸèƒ½ã€‚



åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼š

1\. ä¿æŒä»£ç æ•´æ´å’Œæ–‡æ¡£æ›´æ–°

2\. åŠæ—¶æµ‹è¯•å’Œä¿®å¤é—®é¢˜

3\. æ³¨é‡ç”¨æˆ·ä½“éªŒå’Œæ€§èƒ½

4\. åšå¥½é”™è¯¯å¤„ç†å’Œé™çº§æ–¹æ¡ˆ



ç¥å¼€å‘é¡ºåˆ©ï¼ğŸš€



---



\*\*ç‰ˆæœ¬\*\*: v1.0

\*\*æœ€åæ›´æ–°\*\*: 2025-01-29

\*\*è®¸å¯\*\*: MIT License

